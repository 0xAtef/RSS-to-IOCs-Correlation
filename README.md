# RSS to IOCs Correlation

## Project Description

The **RSS to IOCs Correlation** project is a comprehensive tool designed to automate the collection, processing, and enrichment of Indicators of Compromise (IOCs) from RSS feeds. It is tailored for cybersecurity professionals and organizations that need to monitor threat intelligence feeds and integrate the extracted data into their security workflows, such as MISP (Malware Information Sharing Platform).

This tool processes RSS feeds from various sources, extracts IOCs such as domains, IP addresses, CVEs, and more, and enriches them with contextual information. The enriched data is then saved in multiple formats, including CSV and JSON, for further analysis or integration into threat intelligence platforms like MISP.

Additionally, the project includes a mechanism to create MISP events from the processed IOCs. This process can be automated using a cron job that runs every hour, ensuring that your MISP instance is always up-to-date with the latest threat intelligence.

---

## Key Features

- **Automated RSS Feed Parsing**: Collects data from multiple RSS feeds simultaneously.
- **IOC Extraction**: Identifies IOCs such as domains, IPs, CVEs, and more using customizable regex patterns.
- **IOC Enrichment**: Adds context to IOCs using Named Entity Recognition (NER) and other enrichment techniques.
- **Whitelist Support**: Skips processing of whitelisted domains or URLs to reduce noise.
- **Output Formats**: Generates outputs in CSV and JSON formats for easy integration with other tools.
- **MISP Integration**: Creates MISP events from the processed IOCs, ready for sharing and analysis.
- **Concurrency**: Processes multiple feeds concurrently for faster execution.
- **Error Handling**: Logs errors and skips unhealthy feeds to ensure uninterrupted processing.
- **Cron Job Support**: Automates the entire process, including MISP event creation, on an hourly schedule.

---

## Configuration

Create a configuration file `config.json` in the root directory of the project with the following content:

```json
{
  "org_name": "Your Organization",
  "org_uuid": "123e4567-e89b-12d3-a456-426614174000",
  "feed_urls": [
    "https://www.us-cert.gov/ncas/alerts.xml",
    "https://www.cert.ssi.gouv.fr/feed/",
    "http://feeds.feedburner.com/TheHackersNews"
  ],
  "ioc_patterns": {
    "domains": "\\b(?:[a-zA-Z0-9-]+\\.)+[a-zA-Z]{2,}\\b",
    "ips": "\\b(?:\\d{1,3}\\.){3}\\d{1,3}\\b",
    "cves": "\\bCVE-\\d{4}-\\d{4,7}\\b"
  },
  "whitelist_by_feed": {
    "*": ["example.com", "github.com", "microsoft.com"]
  },
  "output_base_dir": "output",
  "seen_iocs_path": "output/seen_iocs.json"
}
```

### Configuration Details

- org_name: The name of your organization.
- org_uuid: A unique identifier for your organization.
- feed_urls: A list of RSS feed URLs to process.
- ioc_patterns: Regex patterns for extracting IOCs (domains, IPs, CVEs, etc.).
- whitelist_by_feed: A dictionary of domains or URLs to skip during processing.
- output_base_dir: Directory where output files will be saved.
- seen_iocs_path: Path to the file storing already processed IOCs.

## MISP Configuration

To integrate with MISP, initialize the MISP client using the following code in the MISP_Event_Creation_From_RSS_IOC_Collector.py script:

```python
from pymisp import ExpandedPyMISP
```

### Initialize MISP instance

```python
misp = ExpandedPyMISP('https://<MISP_URL>', '<API_KEY>', ssl=False)
```

Running the MISP Event Creation Script
After processing the RSS feeds, run the following command to create MISP events from the processed IOCs:

```python
python MISP_Event_Creation_From_RSS_IOC_Collector.py
```

This script will:

- Parse the feed.csv file generated by the RSS IOC collector.
- Create MISP events for each unique UUID in the feed.
- Add attributes (IOCs) to the corresponding events in your MISP instance.

## Automating with a Cron Job

To automate the entire process, including MISP event creation, you can set up a cron job that runs every hour.

### Example Cron Job

1. Open the crontab editor:

```bash
crontab -e
```

2. Add the following entry to run the process every hour:

```bash
0 * * * * cd /path/to/RSS-to-IOCs-Correlation && python rss_ioc_collector.py && python MISP_Event_Creation_From_RSS_IOC_Collector.py >> logs/cron.log 2>&1
```

3. Save and exit.

#### Explanation

- `0 * * * *`: Runs the job at the start of every hour.
- `cd /path/to/RSS-to-IOCs-Correlation`: Navigates to the project directory.
- `python rss_ioc_collector.py`: Runs the IOC collection process.
- `python MISP_Event_Creation_From_RSS_IOC_Collector.py`: Creates MISP events from the collected IOCs.
- >> logs/cron.log 2>&1: Logs output and errors to logs/cron.log.

#### Outputs

The following files are generated after processing:

- CSV Feed: misp_feed/feed.csv (MISP-compatible format).
- JSON Output: output/output.json (all processed records).
- Seen IOCs: output/seen_iocs.json (list of already processed IOCs).

## Contributing

Contributions are welcome! Please follow these steps:

- Fork the repository.
- Create a new branch for your feature or bug fix.
- Submit a pull request.

### Fixes and Enhancements:
1. **Improved Formatting**: Fixed indentation and alignment issues.
2. **Consistent Terminology**: Ensured consistent use of terms like "MISP" and "IOC."
3. **Cron Job Section**: Clarified and formatted the cron job explanation.
4. **Outputs Section**: Clearly listed the generated files and their purposes.
5. **Contributing Section**: Improved readability and structure.

Let me know if you need further adjustments!